{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "MTsvYpNyz89r"
   },
   "source": [
    "# Importing libraries, data & mounting drive"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "id": "z4GrJkPp0Sa9"
   },
   "outputs": [],
   "source": [
    "# Performing linear regression on a dataset with transformed features\n",
    "# Created by Sebastian Bommer 2020-05-17\n",
    "# Modified by Sebastian Bommer 2021-03-28"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "MdnrbPhs0l3s"
   },
   "source": [
    "Ridge regression:\n",
    "![image.png](data:image/png;base64,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)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "id": "iJO8az8NkuzA"
   },
   "outputs": [],
   "source": [
    "# importing libraries\n",
    "import pandas as pd\n",
    "import sklearn\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 34
    },
    "executionInfo": {
     "elapsed": 1379,
     "status": "ok",
     "timestamp": 1589772056656,
     "user": {
      "displayName": "Sebastian B.",
      "photoUrl": "",
      "userId": "12274578952722913819"
     },
     "user_tz": 420
    },
    "id": "dY3iGC20c27F",
    "outputId": "a2855597-93a4-4c93-da9f-015b47b18fb1"
   },
   "outputs": [],
   "source": [
    "# # mounting google drive for use with google collab\n",
    "# from google.colab import drive\n",
    "# drive.mount('/content/drive')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 340
    },
    "executionInfo": {
     "elapsed": 1286,
     "status": "ok",
     "timestamp": 1589772059191,
     "user": {
      "displayName": "Sebastian B.",
      "photoUrl": "",
      "userId": "12274578952722913819"
     },
     "user_tz": 420
    },
    "id": "qu7N6z0LkzyT",
    "outputId": "2e1cd8f2-c744-4cf4-c1d1-aa17ee670990"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      " Data: \n",
      "             y    x1    x2    x3    x4    x5\n",
      "Id                                         \n",
      "0   -6.822679  0.02  0.05 -0.09 -0.43 -0.08\n",
      "1   -6.326290 -0.13  0.11 -0.08 -0.29 -0.03\n",
      "2   -9.302728  0.08  0.06 -0.07 -0.41 -0.03\n",
      "3   -7.371893  0.02 -0.12  0.01 -0.43 -0.02\n",
      "4   -6.027647 -0.14 -0.12 -0.08 -0.02 -0.08\n",
      "..        ...   ...   ...   ...   ...   ...\n",
      "695 -6.147394  0.31 -0.09  0.04 -0.09  0.03\n",
      "696 -6.214899 -0.26 -0.01  0.02 -0.40  0.05\n",
      "697 -6.841341 -0.27 -0.22 -0.01 -0.32 -0.05\n",
      "698 -6.523371  0.19  0.11 -0.05 -0.27 -0.04\n",
      "699 -5.676683 -0.09 -0.09 -0.06 -0.41 -0.06\n",
      "\n",
      "[700 rows x 6 columns]\n"
     ]
    }
   ],
   "source": [
    "# loading data\n",
    "path = r'.\\data\\train.csv'\n",
    "\n",
    "D = pd.read_csv(path, index_col='Id')\n",
    "print(f'\\n Data: \\n {D}')\n",
    "\n",
    "X_df = D.iloc[:,1::]\n",
    "y_df = D.iloc[:,0]\n",
    "\n",
    "X = np.array(X_df)\n",
    "y = np.array(y_df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "TydYBxEflvrp"
   },
   "source": [
    "# Extending X with feature transformation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 450
    },
    "executionInfo": {
     "elapsed": 1262,
     "status": "ok",
     "timestamp": 1589772063266,
     "user": {
      "displayName": "Sebastian B.",
      "photoUrl": "",
      "userId": "12274578952722913819"
     },
     "user_tz": 420
    },
    "id": "XGMRCFxEkTpK",
    "outputId": "7cd0dd9c-bd62-4d43-fdd3-e21d35e96cf2"
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>x1</th>\n",
       "      <th>x2</th>\n",
       "      <th>x3</th>\n",
       "      <th>x4</th>\n",
       "      <th>x5</th>\n",
       "      <th>x1</th>\n",
       "      <th>x2</th>\n",
       "      <th>x3</th>\n",
       "      <th>x4</th>\n",
       "      <th>x5</th>\n",
       "      <th>...</th>\n",
       "      <th>x2</th>\n",
       "      <th>x3</th>\n",
       "      <th>x4</th>\n",
       "      <th>x5</th>\n",
       "      <th>x1</th>\n",
       "      <th>x2</th>\n",
       "      <th>x3</th>\n",
       "      <th>x4</th>\n",
       "      <th>x5</th>\n",
       "      <th>const</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.02</td>\n",
       "      <td>0.05</td>\n",
       "      <td>-0.09</td>\n",
       "      <td>-0.43</td>\n",
       "      <td>-0.08</td>\n",
       "      <td>0.0004</td>\n",
       "      <td>0.0025</td>\n",
       "      <td>0.0081</td>\n",
       "      <td>0.1849</td>\n",
       "      <td>0.0064</td>\n",
       "      <td>...</td>\n",
       "      <td>0.879270</td>\n",
       "      <td>0.819283</td>\n",
       "      <td>0.699731</td>\n",
       "      <td>0.823446</td>\n",
       "      <td>0.857467</td>\n",
       "      <td>0.857012</td>\n",
       "      <td>0.855799</td>\n",
       "      <td>0.817026</td>\n",
       "      <td>0.856167</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>-0.13</td>\n",
       "      <td>0.11</td>\n",
       "      <td>-0.08</td>\n",
       "      <td>-0.29</td>\n",
       "      <td>-0.03</td>\n",
       "      <td>0.0169</td>\n",
       "      <td>0.0121</td>\n",
       "      <td>0.0064</td>\n",
       "      <td>0.0841</td>\n",
       "      <td>0.0009</td>\n",
       "      <td>...</td>\n",
       "      <td>0.905165</td>\n",
       "      <td>0.823446</td>\n",
       "      <td>0.743256</td>\n",
       "      <td>0.844625</td>\n",
       "      <td>0.853889</td>\n",
       "      <td>0.854931</td>\n",
       "      <td>0.856167</td>\n",
       "      <td>0.839215</td>\n",
       "      <td>0.857358</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.08</td>\n",
       "      <td>0.06</td>\n",
       "      <td>-0.07</td>\n",
       "      <td>-0.41</td>\n",
       "      <td>-0.03</td>\n",
       "      <td>0.0064</td>\n",
       "      <td>0.0036</td>\n",
       "      <td>0.0049</td>\n",
       "      <td>0.1681</td>\n",
       "      <td>0.0009</td>\n",
       "      <td>...</td>\n",
       "      <td>0.883615</td>\n",
       "      <td>0.827636</td>\n",
       "      <td>0.705443</td>\n",
       "      <td>0.844625</td>\n",
       "      <td>0.856167</td>\n",
       "      <td>0.856774</td>\n",
       "      <td>0.856492</td>\n",
       "      <td>0.820730</td>\n",
       "      <td>0.857358</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.02</td>\n",
       "      <td>-0.12</td>\n",
       "      <td>0.01</td>\n",
       "      <td>-0.43</td>\n",
       "      <td>-0.02</td>\n",
       "      <td>0.0004</td>\n",
       "      <td>0.0144</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>0.1849</td>\n",
       "      <td>0.0004</td>\n",
       "      <td>...</td>\n",
       "      <td>0.806965</td>\n",
       "      <td>0.861886</td>\n",
       "      <td>0.699731</td>\n",
       "      <td>0.848920</td>\n",
       "      <td>0.857467</td>\n",
       "      <td>0.854432</td>\n",
       "      <td>0.857532</td>\n",
       "      <td>0.817026</td>\n",
       "      <td>0.857467</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>-0.14</td>\n",
       "      <td>-0.12</td>\n",
       "      <td>-0.08</td>\n",
       "      <td>-0.02</td>\n",
       "      <td>-0.08</td>\n",
       "      <td>0.0196</td>\n",
       "      <td>0.0144</td>\n",
       "      <td>0.0064</td>\n",
       "      <td>0.0004</td>\n",
       "      <td>0.0064</td>\n",
       "      <td>...</td>\n",
       "      <td>0.806965</td>\n",
       "      <td>0.823446</td>\n",
       "      <td>0.848920</td>\n",
       "      <td>0.823446</td>\n",
       "      <td>0.853303</td>\n",
       "      <td>0.854432</td>\n",
       "      <td>0.856167</td>\n",
       "      <td>0.857467</td>\n",
       "      <td>0.856167</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>695</th>\n",
       "      <td>0.31</td>\n",
       "      <td>-0.09</td>\n",
       "      <td>0.04</td>\n",
       "      <td>-0.09</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.0961</td>\n",
       "      <td>0.0081</td>\n",
       "      <td>0.0016</td>\n",
       "      <td>0.0081</td>\n",
       "      <td>0.0009</td>\n",
       "      <td>...</td>\n",
       "      <td>0.819283</td>\n",
       "      <td>0.874922</td>\n",
       "      <td>0.819283</td>\n",
       "      <td>0.870574</td>\n",
       "      <td>0.836581</td>\n",
       "      <td>0.855799</td>\n",
       "      <td>0.857207</td>\n",
       "      <td>0.855799</td>\n",
       "      <td>0.857358</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>696</th>\n",
       "      <td>-0.26</td>\n",
       "      <td>-0.01</td>\n",
       "      <td>0.02</td>\n",
       "      <td>-0.40</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.0676</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>0.0004</td>\n",
       "      <td>0.1600</td>\n",
       "      <td>0.0025</td>\n",
       "      <td>...</td>\n",
       "      <td>0.853230</td>\n",
       "      <td>0.866228</td>\n",
       "      <td>0.708361</td>\n",
       "      <td>0.879270</td>\n",
       "      <td>0.842831</td>\n",
       "      <td>0.857532</td>\n",
       "      <td>0.857467</td>\n",
       "      <td>0.822516</td>\n",
       "      <td>0.857012</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>697</th>\n",
       "      <td>-0.27</td>\n",
       "      <td>-0.22</td>\n",
       "      <td>-0.01</td>\n",
       "      <td>-0.32</td>\n",
       "      <td>-0.05</td>\n",
       "      <td>0.0729</td>\n",
       "      <td>0.0484</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>0.1024</td>\n",
       "      <td>0.0025</td>\n",
       "      <td>...</td>\n",
       "      <td>0.768119</td>\n",
       "      <td>0.853230</td>\n",
       "      <td>0.733230</td>\n",
       "      <td>0.836088</td>\n",
       "      <td>0.841671</td>\n",
       "      <td>0.847029</td>\n",
       "      <td>0.857532</td>\n",
       "      <td>0.835197</td>\n",
       "      <td>0.857012</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>698</th>\n",
       "      <td>0.19</td>\n",
       "      <td>0.11</td>\n",
       "      <td>-0.05</td>\n",
       "      <td>-0.27</td>\n",
       "      <td>-0.04</td>\n",
       "      <td>0.0361</td>\n",
       "      <td>0.0121</td>\n",
       "      <td>0.0025</td>\n",
       "      <td>0.0729</td>\n",
       "      <td>0.0016</td>\n",
       "      <td>...</td>\n",
       "      <td>0.905165</td>\n",
       "      <td>0.836088</td>\n",
       "      <td>0.750152</td>\n",
       "      <td>0.840347</td>\n",
       "      <td>0.849712</td>\n",
       "      <td>0.854931</td>\n",
       "      <td>0.857012</td>\n",
       "      <td>0.841671</td>\n",
       "      <td>0.857207</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>699</th>\n",
       "      <td>-0.09</td>\n",
       "      <td>-0.09</td>\n",
       "      <td>-0.06</td>\n",
       "      <td>-0.41</td>\n",
       "      <td>-0.06</td>\n",
       "      <td>0.0081</td>\n",
       "      <td>0.0081</td>\n",
       "      <td>0.0036</td>\n",
       "      <td>0.1681</td>\n",
       "      <td>0.0036</td>\n",
       "      <td>...</td>\n",
       "      <td>0.819283</td>\n",
       "      <td>0.831851</td>\n",
       "      <td>0.705443</td>\n",
       "      <td>0.831851</td>\n",
       "      <td>0.855799</td>\n",
       "      <td>0.855799</td>\n",
       "      <td>0.856774</td>\n",
       "      <td>0.820730</td>\n",
       "      <td>0.856774</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>700 rows × 336 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       x1    x2    x3    x4    x5      x1      x2      x3      x4      x5  \\\n",
       "Id                                                                          \n",
       "0    0.02  0.05 -0.09 -0.43 -0.08  0.0004  0.0025  0.0081  0.1849  0.0064   \n",
       "1   -0.13  0.11 -0.08 -0.29 -0.03  0.0169  0.0121  0.0064  0.0841  0.0009   \n",
       "2    0.08  0.06 -0.07 -0.41 -0.03  0.0064  0.0036  0.0049  0.1681  0.0009   \n",
       "3    0.02 -0.12  0.01 -0.43 -0.02  0.0004  0.0144  0.0001  0.1849  0.0004   \n",
       "4   -0.14 -0.12 -0.08 -0.02 -0.08  0.0196  0.0144  0.0064  0.0004  0.0064   \n",
       "..    ...   ...   ...   ...   ...     ...     ...     ...     ...     ...   \n",
       "695  0.31 -0.09  0.04 -0.09  0.03  0.0961  0.0081  0.0016  0.0081  0.0009   \n",
       "696 -0.26 -0.01  0.02 -0.40  0.05  0.0676  0.0001  0.0004  0.1600  0.0025   \n",
       "697 -0.27 -0.22 -0.01 -0.32 -0.05  0.0729  0.0484  0.0001  0.1024  0.0025   \n",
       "698  0.19  0.11 -0.05 -0.27 -0.04  0.0361  0.0121  0.0025  0.0729  0.0016   \n",
       "699 -0.09 -0.09 -0.06 -0.41 -0.06  0.0081  0.0081  0.0036  0.1681  0.0036   \n",
       "\n",
       "     ...        x2        x3        x4        x5        x1        x2  \\\n",
       "Id   ...                                                               \n",
       "0    ...  0.879270  0.819283  0.699731  0.823446  0.857467  0.857012   \n",
       "1    ...  0.905165  0.823446  0.743256  0.844625  0.853889  0.854931   \n",
       "2    ...  0.883615  0.827636  0.705443  0.844625  0.856167  0.856774   \n",
       "3    ...  0.806965  0.861886  0.699731  0.848920  0.857467  0.854432   \n",
       "4    ...  0.806965  0.823446  0.848920  0.823446  0.853303  0.854432   \n",
       "..   ...       ...       ...       ...       ...       ...       ...   \n",
       "695  ...  0.819283  0.874922  0.819283  0.870574  0.836581  0.855799   \n",
       "696  ...  0.853230  0.866228  0.708361  0.879270  0.842831  0.857532   \n",
       "697  ...  0.768119  0.853230  0.733230  0.836088  0.841671  0.847029   \n",
       "698  ...  0.905165  0.836088  0.750152  0.840347  0.849712  0.854931   \n",
       "699  ...  0.819283  0.831851  0.705443  0.831851  0.855799  0.855799   \n",
       "\n",
       "           x3        x4        x5  const  \n",
       "Id                                        \n",
       "0    0.855799  0.817026  0.856167      1  \n",
       "1    0.856167  0.839215  0.857358      1  \n",
       "2    0.856492  0.820730  0.857358      1  \n",
       "3    0.857532  0.817026  0.857467      1  \n",
       "4    0.856167  0.857467  0.856167      1  \n",
       "..        ...       ...       ...    ...  \n",
       "695  0.857207  0.855799  0.857358      1  \n",
       "696  0.857467  0.822516  0.857012      1  \n",
       "697  0.857532  0.835197  0.857012      1  \n",
       "698  0.857012  0.841671  0.857207      1  \n",
       "699  0.856774  0.820730  0.856774      1  \n",
       "\n",
       "[700 rows x 336 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# feature transformation\n",
    "squared = X_df**2\n",
    "exponential = np.exp(X_df)\n",
    "cosine = np.cos(X_df)\n",
    "\n",
    "# Concatenating transformed features\n",
    "X_df = pd.concat([X_df, squared, exponential, cosine], axis=1, sort=False)\n",
    "X_df['const'] = 1  # adding constant term\n",
    "X = np.array(X_df)\n",
    "X_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "D_mAarVLquD-"
   },
   "source": [
    "# Creating k-fold split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "id": "Ip1-H7XTq3Ah"
   },
   "outputs": [],
   "source": [
    "from sklearn.model_selection import KFold\n",
    "\n",
    "# hyper parameter\n",
    "n_fold = 10\n",
    "\n",
    "kf = KFold(n_fold, shuffle=False)\n",
    "\n",
    "ind = np.arange(y.shape[0])\n",
    "\n",
    "ind_splits = list(kf.split(ind))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 238
    },
    "executionInfo": {
     "elapsed": 1754,
     "status": "ok",
     "timestamp": 1589772071358,
     "user": {
      "displayName": "Sebastian B.",
      "photoUrl": "",
      "userId": "12274578952722913819"
     },
     "user_tz": 420
    },
    "id": "JXHNiwHlCZTd",
    "outputId": "09f3a8a0-aa0c-4085-9db1-39dff099da4a"
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[-0.08      , -0.14      , -0.04      , ...,  0.94923542,\n",
       "         1.        ,  1.        ],\n",
       "       [ 0.02      , -0.05      , -0.07      , ...,  0.95824388,\n",
       "         0.99995   ,  1.        ],\n",
       "       [ 0.04      , -0.06      , -0.12      , ...,  0.99875026,\n",
       "         0.99595273,  1.        ],\n",
       "       ...,\n",
       "       [-0.27      , -0.22      , -0.01      , ...,  0.94923542,\n",
       "         0.99875026,  1.        ],\n",
       "       [ 0.19      ,  0.11      , -0.05      , ...,  0.9637709 ,\n",
       "         0.99920011,  1.        ],\n",
       "       [-0.09      , -0.09      , -0.06      , ...,  0.91712082,\n",
       "         0.99820054,  1.        ]])"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X[ind_splits[0][0],:]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "0IDhYJZEqnuP"
   },
   "source": [
    "# Train ridge regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "id": "vo8UCcugop0x"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training on 0 fold and lambda 0.01\n",
      "Training on 1 fold and lambda 0.01\n",
      "Training on 2 fold and lambda 0.01\n",
      "Training on 3 fold and lambda 0.01\n",
      "Training on 4 fold and lambda 0.01\n",
      "Training on 5 fold and lambda 0.01\n",
      "Training on 6 fold and lambda 0.01\n",
      "Training on 7 fold and lambda 0.01\n",
      "Training on 8 fold and lambda 0.01\n",
      "Training on 9 fold and lambda 0.01\n",
      "Training on 0 fold and lambda 0.1\n",
      "Training on 1 fold and lambda 0.1\n",
      "Training on 2 fold and lambda 0.1\n",
      "Training on 3 fold and lambda 0.1\n",
      "Training on 4 fold and lambda 0.1\n",
      "Training on 5 fold and lambda 0.1\n",
      "Training on 6 fold and lambda 0.1\n",
      "Training on 7 fold and lambda 0.1\n",
      "Training on 8 fold and lambda 0.1\n",
      "Training on 9 fold and lambda 0.1\n",
      "Training on 0 fold and lambda 1\n",
      "Training on 1 fold and lambda 1\n",
      "Training on 2 fold and lambda 1\n",
      "Training on 3 fold and lambda 1\n",
      "Training on 4 fold and lambda 1\n",
      "Training on 5 fold and lambda 1\n",
      "Training on 6 fold and lambda 1\n",
      "Training on 7 fold and lambda 1\n",
      "Training on 8 fold and lambda 1\n",
      "Training on 9 fold and lambda 1\n",
      "Training on 0 fold and lambda 10\n",
      "Training on 1 fold and lambda 10\n",
      "Training on 2 fold and lambda 10\n",
      "Training on 3 fold and lambda 10\n",
      "Training on 4 fold and lambda 10\n",
      "Training on 5 fold and lambda 10\n",
      "Training on 6 fold and lambda 10\n",
      "Training on 7 fold and lambda 10\n",
      "Training on 8 fold and lambda 10\n",
      "Training on 9 fold and lambda 10\n",
      "Training on 0 fold and lambda 100\n",
      "Training on 1 fold and lambda 100\n",
      "Training on 2 fold and lambda 100\n",
      "Training on 3 fold and lambda 100\n",
      "Training on 4 fold and lambda 100\n",
      "Training on 5 fold and lambda 100\n",
      "Training on 6 fold and lambda 100\n",
      "Training on 7 fold and lambda 100\n",
      "Training on 8 fold and lambda 100\n",
      "Training on 9 fold and lambda 100\n",
      "Training on 0 fold and lambda 10000.0\n",
      "Training on 1 fold and lambda 10000.0\n",
      "Training on 2 fold and lambda 10000.0\n",
      "Training on 3 fold and lambda 10000.0\n",
      "Training on 4 fold and lambda 10000.0\n",
      "Training on 5 fold and lambda 10000.0\n",
      "Training on 6 fold and lambda 10000.0\n",
      "Training on 7 fold and lambda 10000.0\n",
      "Training on 8 fold and lambda 10000.0\n",
      "Training on 9 fold and lambda 10000.0\n",
      "Training on 0 fold and lambda 100000.0\n",
      "Training on 1 fold and lambda 100000.0\n",
      "Training on 2 fold and lambda 100000.0\n",
      "Training on 3 fold and lambda 100000.0\n",
      "Training on 4 fold and lambda 100000.0\n",
      "Training on 5 fold and lambda 100000.0\n",
      "Training on 6 fold and lambda 100000.0\n",
      "Training on 7 fold and lambda 100000.0\n",
      "Training on 8 fold and lambda 100000.0\n",
      "Training on 9 fold and lambda 100000.0\n",
      "The RMSE are: [2.01  2.041 2.008 1.973 1.958 1.955 1.958]\n"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import Ridge\n",
    "from sklearn.metrics import mean_squared_error\n",
    "\n",
    "lam = [0.01, 0.1, 1, 10, 100, 1e4,1e5]\n",
    "\n",
    "errors = []\n",
    "models = []\n",
    "\n",
    "for alph in lam:\n",
    "\n",
    "  clf = Ridge(alpha=alph,solver='cholesky')\n",
    "\n",
    "  errorVec = []\n",
    "  tempModel = []\n",
    "  for i in range(len(ind_splits)):\n",
    "    print(f'Training on {i} fold and lambda {alph}')\n",
    "    model = clf.fit(X[ind_splits[i][0],:], y[ind_splits[i][0]])\n",
    "    y_pred = model.predict(X[ind_splits[i][1],:])\n",
    "\n",
    "    tempModel.append(model)\n",
    "    errorVec.append(np.sqrt(mean_squared_error(y_pred, y[ind_splits[i][1]])))\n",
    "  errors.append(np.mean(errorVec))\n",
    "  models.append(tempModel)\n",
    "\n",
    "print(f'The RMSE are: {np.round(errors,3)}')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "SZU9P5RVyube"
   },
   "source": [
    "# Exporting to csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 1.12732979e+00, -5.11343077e-01, -5.52543077e-02,  1.11060379e+00,\n",
       "       -5.58004340e-02, -1.05961470e+00, -1.88956386e-01,  5.36369628e-01,\n",
       "       -2.19986733e-01,  8.49100511e-02,  7.33693821e-01, -5.03072790e-01,\n",
       "        9.15712396e-02,  9.23557657e-01, -1.60724724e-02,  4.71609274e-01,\n",
       "        9.33106841e-02, -2.37994413e-01,  8.21494566e-02, -2.23600291e-02,\n",
       "        0.00000000e+00, -1.05961470e+00, -1.88956386e-01,  5.36369628e-01,\n",
       "       -2.19986733e-01,  8.49100511e-02, -1.40262911e+00, -1.97085137e-02,\n",
       "        7.31132225e-01, -6.82715857e-01,  5.04294994e-01,  8.72687568e-01,\n",
       "       -6.24988345e-01,  1.65628985e-01,  1.07764312e+00,  9.60445265e-02,\n",
       "        5.99875943e-01,  1.71510669e-01, -3.01329119e-01,  1.17432137e-02,\n",
       "        5.45871838e-02,  0.00000000e+00,  7.33693821e-01, -5.03072790e-01,\n",
       "        9.15712396e-02,  9.23557657e-01, -1.60724724e-02, -1.79085728e+00,\n",
       "       -1.53155351e-01,  9.36300558e-01, -6.32017353e-01,  4.62620984e-01,\n",
       "        1.02709452e+00, -6.99908577e-01,  1.60603933e-01,  1.24965049e+00,\n",
       "        1.47625055e-01,  8.25048465e-01,  2.20664322e-01, -4.20036321e-01,\n",
       "        4.07025051e-02,  4.27732331e-02,  0.00000000e+00,  4.71609274e-01,\n",
       "        9.33106841e-02, -2.37994413e-01,  8.21494566e-02, -2.23600291e-02,\n",
       "        7.00799973e-01,  1.35025454e-02, -3.64157380e-01,  3.42264675e-01,\n",
       "       -2.38759292e-01, -5.07303685e-01,  3.70137027e-01, -9.34680863e-02,\n",
       "       -6.42557798e-01, -1.39027911e-02, -3.01068746e-01, -7.83429546e-02,\n",
       "        1.49811059e-01, -2.02328615e-02, -1.79158052e-02,  0.00000000e+00,\n",
       "       -1.05961470e+00, -1.88956386e-01,  5.36369628e-01, -2.19986733e-01,\n",
       "        8.49100511e-02, -1.40262911e+00, -1.97085137e-02,  7.31132225e-01,\n",
       "       -6.82715857e-01,  5.04294994e-01,  8.72687568e-01, -6.24988345e-01,\n",
       "        1.65628985e-01,  1.07764312e+00,  9.60445265e-02,  5.99875943e-01,\n",
       "        1.71510669e-01, -3.01329119e-01,  1.17432137e-02,  5.45871838e-02,\n",
       "        0.00000000e+00, -1.40262911e+00, -1.97085137e-02,  7.31132225e-01,\n",
       "       -6.82715857e-01,  5.04294994e-01, -1.23453302e-02,  8.77049319e-02,\n",
       "        3.38313238e-02,  2.29195675e-02,  3.22727943e-01, -2.12691509e+00,\n",
       "        1.60085464e+00, -2.86350709e-01, -2.86076925e+00,  8.60932892e-01,\n",
       "       -8.76900914e-02,  1.72838197e-01,  3.41313092e-03, -3.67962830e-01,\n",
       "        2.29651924e-01,  0.00000000e+00,  8.72687568e-01, -6.24988345e-01,\n",
       "        1.65628985e-01,  1.07764312e+00,  9.60445265e-02, -5.16803692e+00,\n",
       "       -1.82699336e-02,  2.82222906e+00, -2.34653102e+00,  2.31870259e+00,\n",
       "       -1.67020507e+00,  7.85352424e-01,  8.18072457e-02, -1.34470759e+00,\n",
       "        1.70289224e+00,  2.10529997e+00,  8.96657468e-01, -1.15927849e+00,\n",
       "       -5.04377997e-01,  4.93020523e-01,  0.00000000e+00,  5.99875943e-01,\n",
       "        1.71510669e-01, -3.01329119e-01,  1.17432137e-02,  5.45871838e-02,\n",
       "        1.39850790e+00,  4.87491899e-02, -7.19884092e-01,  6.88822287e-01,\n",
       "       -3.98589676e-01, -1.07955682e+00,  8.91122514e-01, -2.21592889e-01,\n",
       "       -1.57044121e+00,  1.31997498e-01, -5.58469015e-01, -1.09159775e-01,\n",
       "        2.74496071e-01, -1.04853037e-01,  1.49764930e-02,  0.00000000e+00,\n",
       "        7.33693821e-01, -5.03072790e-01,  9.15712396e-02,  9.23557658e-01,\n",
       "       -1.60724724e-02, -1.79085728e+00, -1.53155351e-01,  9.36300558e-01,\n",
       "       -6.32017353e-01,  4.62620984e-01,  1.02709452e+00, -6.99908576e-01,\n",
       "        1.60603933e-01,  1.24965049e+00,  1.47625055e-01,  8.25048465e-01,\n",
       "        2.20664322e-01, -4.20036321e-01,  4.07025051e-02,  4.27732331e-02,\n",
       "        0.00000000e+00, -1.79085728e+00, -1.53155351e-01,  9.36300558e-01,\n",
       "       -6.32017353e-01,  4.62620984e-01, -1.40877866e+00,  2.48810652e-02,\n",
       "        7.48157110e-01, -6.65274397e-01,  6.72919583e-01, -2.97148046e+00,\n",
       "        1.35157975e+00, -1.06213800e-01, -2.23593034e+00,  4.89248918e-01,\n",
       "       -4.61557144e-02,  1.63578043e-01, -6.74288609e-02, -3.10994699e-01,\n",
       "        1.53133558e-01,  0.00000000e+00,  1.02709452e+00, -6.99908576e-01,\n",
       "        1.60603933e-01,  1.24965049e+00,  1.47625055e-01, -7.11381503e+00,\n",
       "        1.78836612e-01,  3.95654224e+00, -3.28255553e+00,  3.84423266e+00,\n",
       "        5.51446632e-01, -2.49291734e-01, -1.25854166e-01,  3.66162852e-01,\n",
       "       -8.12830498e-01, -4.51596338e+00,  6.94761423e-02,  1.15637642e+00,\n",
       "       -2.28779476e+00,  4.29148563e-01,  0.00000000e+00,  8.25048465e-01,\n",
       "        2.20664322e-01, -4.20036321e-01,  4.07025051e-02,  4.27732331e-02,\n",
       "        1.90076161e+00,  6.60121274e-02, -9.78460662e-01,  9.34324295e-01,\n",
       "       -5.44047487e-01, -1.19802800e+00,  1.01995540e+00, -2.64614782e-01,\n",
       "       -1.78969799e+00,  1.07468266e-01, -7.20476831e-01, -1.51304136e-01,\n",
       "        3.57565203e-01, -1.15388933e-01,  8.77973349e-03,  0.00000000e+00,\n",
       "        4.71609274e-01,  9.33106841e-02, -2.37994413e-01,  8.21494566e-02,\n",
       "       -2.23600291e-02,  7.00799973e-01,  1.35025454e-02, -3.64157380e-01,\n",
       "        3.42264675e-01, -2.38759292e-01, -5.07303685e-01,  3.70137027e-01,\n",
       "       -9.34680863e-02, -6.42557798e-01, -1.39027911e-02, -3.01068746e-01,\n",
       "       -7.83429546e-02,  1.49811059e-01, -2.02328615e-02, -1.79158052e-02,\n",
       "        0.00000000e+00,  7.00799973e-01,  1.35025454e-02, -3.64157380e-01,\n",
       "        3.42264675e-01, -2.38759292e-01,  6.17285552e-03, -4.38458991e-02,\n",
       "       -1.69152219e-02, -1.12821918e-02, -1.61175798e-01, -2.58524023e-01,\n",
       "       -3.17452367e-01,  1.10598462e-01,  6.88148837e-01, -4.62053462e-01,\n",
       "       -1.34220463e-01, -1.21016331e-01,  6.72238988e-02,  1.55257629e-01,\n",
       "       -1.29178936e-01,  0.00000000e+00, -5.07303685e-01,  3.70137027e-01,\n",
       "       -9.34680863e-02, -6.42557798e-01, -1.39027911e-02,  1.90787386e+00,\n",
       "        1.11827150e-01, -1.00770248e+00,  7.88892267e-01, -5.64252735e-01,\n",
       "       -5.84413315e+00,  3.20171742e+00, -5.26644266e-01, -5.53831205e+00,\n",
       "        4.03924200e-01, -1.39414502e+00, -2.66763483e-01,  6.52909969e-01,\n",
       "       -2.69021572e-01,  7.36632022e-03,  0.00000000e+00, -3.01068746e-01,\n",
       "       -7.83429546e-02,  1.49811059e-01, -2.02328615e-02, -1.79158052e-02,\n",
       "       -5.88869907e-01, -1.73121221e-02,  3.04138933e-01, -2.89751297e-01,\n",
       "        1.78868596e-01,  5.29891499e-01, -4.13986333e-01,  9.99571475e-02,\n",
       "        7.29879900e-01, -5.52701036e-02,  2.53747315e-01,  5.20933962e-02,\n",
       "       -1.24206408e-01,  4.31466840e-02, -2.40346366e-03,  0.00000000e+00])"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "models[0][0].coef_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "id": "Cr2LaYOCuJYo"
   },
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "cannot unpack non-iterable numpy.float64 object",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-19-78395826262b>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0me\u001b[0m\u001b[1;33m,\u001b[0m\u001b[0midx\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mmin\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0marray\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0merrors\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      2\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[0mweights\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mDataFrame\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mmodels\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m3\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m0\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mcoef_\u001b[0m\u001b[1;33m)\u001b[0m  \u001b[1;31m#choosing model with lowest RMSE\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      4\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      5\u001b[0m \u001b[1;31m# create timestamp\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mTypeError\u001b[0m: cannot unpack non-iterable numpy.float64 object"
     ]
    }
   ],
   "source": [
    "min_idx = errors.index(min(errors))  # idx with lowest RMSE\n",
    "\n",
    "weights = pd.DataFrame(models[3][0].coef_)  #choosing model with lowest RMSE\n",
    "\n",
    "# create timestamp\n",
    "import time\n",
    "tstamp = round(time.time())\n",
    "\n",
    "filePath = f\".\\\\results\\\\weights_{tstamp}.csv\"\n",
    "weights.to_csv(filePath, index=False, float_format='%.3f',header=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 102
    },
    "executionInfo": {
     "elapsed": 1791,
     "status": "ok",
     "timestamp": 1589772297196,
     "user": {
      "displayName": "Sebastian B.",
      "photoUrl": "",
      "userId": "12274578952722913819"
     },
     "user_tz": 420
    },
    "id": "DfcGyzL9ykhn",
    "outputId": "454e7546-5119-4fdf-8704-828b28024079"
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([-0.13349034, -0.55583969, -0.59356823, -0.11925668,  0.01354123,\n",
       "       -0.13819497,  0.07661524,  0.10816166,  0.00940635,  0.04382372,\n",
       "       -0.20557915, -0.52038973, -0.54450513, -0.12069086,  0.0304691 ,\n",
       "        0.06846467, -0.03809828, -0.05374952, -0.00492623, -0.02103386,\n",
       "        0.        ])"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "models[3][0].coef_"
   ]
  }
 ],
 "metadata": {
  "colab": {
   "authorship_tag": "ABX9TyOADwvqfLk6QNUNFADm98Lt",
   "collapsed_sections": [],
   "name": "Project_1b.ipynb",
   "provenance": [],
   "toc_visible": true
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
